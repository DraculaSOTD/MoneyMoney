# Multi-Model Cryptocurrency Trading System Configuration
# Production-ready configuration with comprehensive settings

# System Information
system:
  name: "Crypto ML Trading System"
  version: "1.0.0"
  environment: "development"  # development, staging, production
  log_level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL

# Data Configuration
data:
  source: "file"  # file, api, database
  data_dir: "./data/historical"
  symbols: ["BTCUSDT", "ETHUSDT"]
  interval: "1m"
  lookback_days: 30
  max_missing_data: 0.05  # 5% maximum missing data tolerance
  data_validation:
    check_gaps: true
    check_outliers: true
    outlier_threshold: 5.0  # standard deviations

# Feature Engineering
features:
  technical_indicators:
    enabled: true
    indicators:
      - "sma"
      - "ema"
      - "rsi"
      - "macd"
      - "bollinger_bands"
      - "atr"
      - "stochastic"
    periods: [10, 20, 50]
  
  market_microstructure:
    enabled: true
    features:
      - "order_flow_imbalance"
      - "volume_profile"
      - "price_impact"
      - "bid_ask_spread"
    
  alternative_data:
    enabled: false  # Enable when data sources available
    sources:
      - "sentiment"
      - "on_chain"
      - "economic_indicators"

# Model Configuration
models:
  # Statistical Models
  arima:
    enabled: true
    max_p: 5
    max_d: 2
    max_q: 5
    refit_interval: 1440  # minutes (24 hours)
    optimization:
      method: "mle"
      max_iter: 1000
      tolerance: 1e-6
  
  garch:
    enabled: true
    p: 1
    q: 1
    distribution: "t"  # normal, t, skewed_t
    refit_interval: 1440
  
  # Deep Learning Models
  gru_attention:
    enabled: true
    hidden_size: 128
    num_layers: 3
    attention_heads: 8
    dropout: 0.2
    sequence_length: 100
    training:
      batch_size: 64
      epochs: 100
      learning_rate: 0.001
      optimizer: "adam"
      early_stopping_patience: 10
  
  cnn_pattern:
    enabled: true
    input_size: [100, 100]  # GAF image size
    conv_layers:
      - {filters: 32, kernel_size: 3, activation: "relu"}
      - {filters: 64, kernel_size: 3, activation: "relu"}
      - {filters: 128, kernel_size: 3, activation: "relu"}
    fc_layers: [256, 64]
    dropout: 0.3
    training:
      batch_size: 32
      epochs: 150
      learning_rate: 0.0005
      optimizer: "adam"
  
  # Reinforcement Learning
  ppo:
    enabled: true
    policy_network:
      hidden_sizes: [256, 128, 64]
      activation: "relu"
    value_network:
      hidden_sizes: [256, 128, 64]
      activation: "relu"
    training:
      batch_size: 64
      learning_rate: 0.0003
      gamma: 0.99
      gae_lambda: 0.95
      clip_ratio: 0.2
      entropy_coef: 0.01
      value_coef: 0.5
  
  # Hidden Markov Model
  hmm:
    enabled: true
    n_states: null  # Auto-select optimal number
    feature_set: "standard"
    update_interval: 1440
    convergence_threshold: 1e-6
  
  # Advanced Models
  transformer_tft:
    enabled: false  # Enable after basic models are stable
    d_model: 256
    n_heads: 8
    n_layers: 6
    dropout: 0.1
    max_sequence_length: 200
  
  sentiment_analysis:
    enabled: false
    model_type: "transformer"
    vocab_size: 10000
    max_length: 128

# Ensemble Configuration
ensemble:
  enabled: true
  method: "neural_meta_learner"  # simple_average, weighted_average, neural_meta_learner
  meta_learner:
    hidden_sizes: [128, 64, 32]
    dropout: 0.2
    learning_rate: 0.001
  
  model_weights:
    arima: 0.15
    garch: 0.15
    gru_attention: 0.25
    cnn_pattern: 0.20
    ppo: 0.15
    hmm: 0.10
  
  confidence_threshold: 0.6  # Minimum confidence for trading signals

# Risk Management
risk_management:
  max_position_size: 0.20  # 20% of portfolio
  max_portfolio_risk: 0.05  # 5% VaR
  max_drawdown: 0.15  # 15% maximum drawdown
  var_confidence: 0.95
  kelly_fraction: 0.25  # Conservative Kelly fraction
  
  position_sizing:
    method: "kelly_criterion"  # fixed, kelly_criterion, volatility_adjusted
    volatility_lookback: 100  # periods
    volatility_target: 0.15  # 15% annual volatility target
  
  stop_loss:
    enabled: true
    method: "atr_based"  # fixed, atr_based, volatility_based
    atr_multiplier: 2.0
    max_loss: 0.02  # 2% maximum loss per trade
  
  take_profit:
    enabled: true
    risk_reward_ratio: 2.0  # Take profit at 2:1 ratio

# Trading Configuration
trading:
  mode: "simulation"  # simulation, paper, live
  base_currency: "USDT"
  transaction_costs:
    maker_fee: 0.001  # 0.1%
    taker_fee: 0.001  # 0.1%
    slippage: 0.0005  # 0.05%
  
  execution:
    order_type: "market"  # market, limit
    timeout: 30  # seconds
    retry_attempts: 3
  
  signal_generation:
    min_confidence: 0.6
    signal_timeout: 300  # seconds
    conflicting_signal_resolution: "majority_vote"  # majority_vote, confidence_weighted, meta_learner

# Validation and Backtesting
validation:
  method: "walk_forward"  # holdout, kfold, walk_forward, purged_kfold
  train_ratio: 0.7
  validation_ratio: 0.15
  test_ratio: 0.15
  
  walk_forward:
    initial_train_size: 0.5
    step_size: 0.1
    purge_days: 1
    embargo_days: 1
  
  metrics:
    primary: "sharpe_ratio"
    secondary: ["sortino_ratio", "calmar_ratio", "max_drawdown", "total_return"]
    confidence_level: 0.95

# Performance Monitoring
monitoring:
  enabled: true
  update_interval: 60  # seconds
  
  alerts:
    email_enabled: false
    slack_enabled: false
    telegram_enabled: false
  
  performance_tracking:
    benchmark: "BTCUSDT"  # Benchmark for performance comparison
    rolling_window: 252  # Trading days for rolling metrics
    
  drift_detection:
    enabled: true
    statistical_tests: ["ks_test", "psi", "drift_score"]
    alert_threshold: 0.1
    retrain_threshold: 0.2

# Logging Configuration
logging:
  level: "INFO"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  
  handlers:
    console:
      enabled: true
      level: "INFO"
    
    file:
      enabled: true
      level: "DEBUG"
      filename: "logs/trading_system.log"
      max_bytes: 10485760  # 10MB
      backup_count: 5
    
    elasticsearch:
      enabled: false
      host: "localhost"
      port: 9200
      index: "trading_logs"

# Database Configuration
database:
  enabled: false
  type: "postgresql"  # postgresql, mysql, sqlite
  host: "localhost"
  port: 5432
  name: "trading_db"
  user: "trading_user"
  # password: set via environment variable

# API Configuration
api:
  enabled: false
  host: "0.0.0.0"
  port: 8000
  
  rate_limiting:
    enabled: true
    requests_per_minute: 60
  
  authentication:
    enabled: false
    method: "api_key"  # api_key, jwt, oauth

# Deployment Configuration
deployment:
  environment: "development"
  
  docker:
    image_name: "crypto-ml-trading"
    version: "latest"
    port: 8000
  
  kubernetes:
    namespace: "trading"
    replicas: 1
    resources:
      requests:
        cpu: "500m"
        memory: "1Gi"
      limits:
        cpu: "2000m"
        memory: "4Gi"
  
  health_checks:
    enabled: true
    endpoint: "/health"
    interval: 30

# Security Configuration
security:
  encryption:
    enabled: false
    algorithm: "AES-256"
    # key: set via environment variable
  
  api_keys:
    # Define API keys for external services
    binance: null
    coinbase: null
    twitter: null

# Development Configuration
development:
  debug_mode: true
  profiling_enabled: false
  testing:
    enabled: true
    coverage_threshold: 0.8
    fast_mode: false  # Skip long-running tests